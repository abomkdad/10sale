# Create a GitHub-ready mini project with index.html + placeholder image p.qpng + README, then zip it

from PIL import Image, ImageDraw, ImageFont
import os, zipfile, textwrap, io, base64

project_dir = "/mnt/data/whatsapp_order_landing"
os.makedirs(project_dir, exist_ok=True)

# 1) index.html content
index_html = """<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>تأكيد الطلب</title>
  <meta property="og:image" content="p.qpng">
  <style>
    :root { color-scheme: light dark; }
    body { margin: 16px; font-family: Arial, sans-serif; }
    .wrap { max-width: 430px; margin: 0 auto; }
    .campaign { text-align:center; margin-bottom: 12px; }
    .campaign img { max-width: 100%; display:block; border-radius: 12px; margin:0 auto; }
    .fields { display:grid; gap:10px; }
    .fields input, .cta {
      padding: 12px; font-size: 16px; border-radius: 8px; box-sizing: border-box; width: 100%;
    }
    .fields input { border: 1px solid #ccc; }
    .cta {
      display:inline-block; text-align:center; background:#16a34a; color:#fff; font-weight:700; text-decoration:none; border:none; cursor:pointer;
    }
    .cta[aria-disabled="true"] { opacity:.55; pointer-events:none; }
  </style>
</head>
<body>
  <div class="wrap">
    <!-- صورة الحملة (أعدِل الملف p.qpng إلى صورتك بنفس الاسم أو استبدله) -->
    <div class="campaign">
      <img id="campaignImg" src="p.qpng" alt="campaign">
    </div>

    <!-- حقلا الاسم + المدينة وزر واتساب -->
    <div class="fields">
      <input type="text" id="cust-name" placeholder="الاسم" required>
      <input type="text" id="cust-city" placeholder="المدينة" required>
      <a id="goWA" class="cta" aria-disabled="true" href="#">تأكيد الطلب عبر واتساب</a>
    </div>
  </div>

  <script>
  (function () {
    var WA_NUMBER = "972506164130";

    // لغات الواجهة
    var I18N = {
      ar: { dir:"rtl", name:"الاسم", city:"المدينة", btn:"تأكيد الطلب عبر واتساب", confirm:"أنا أؤكد طلب هذه المجموعة.", imageLabel:"رابط الصورة" },
      he: { dir:"rtl", name:"שם",   city:"עיר",      btn:"אישור הזמנה ב־WhatsApp", confirm:"אני מאשר/ת את הזמנת המארז הזה.", imageLabel:"קישור לתמונה" },
      en: { dir:"ltr", name:"Name", city:"City",     btn:"Confirm Order via WhatsApp", confirm:"I confirm ordering this bundle.", imageLabel:"Image link" }
    };
    var lang = (navigator.language && navigator.language.indexOf("he")===0) ? "he"
              : (navigator.language && navigator.language.indexOf("ar")===0) ? "ar"
              : "en";
    var t = I18N[lang];
    document.documentElement.lang = lang;
    document.documentElement.dir  = t.dir;

    // عناصر
    var nameEl = document.getElementById("cust-name");
    var cityEl = document.getElementById("cust-city");
    var waBtn  = document.getElementById("goWA");
    var imgEl  = document.getElementById("campaignImg");

    // ترجمة واجهة
    nameEl.placeholder = t.name;
    cityEl.placeholder = t.city;
    waBtn.textContent  = t.btn;

    function absolutize(url){
      try { return new URL(url, location.href).toString(); } catch(e){ return url; }
    }

    function buildMessage(name, city, imgUrl) {
      var lines = [
        "[" + lang.toUpperCase() + "] " + t.confirm,
        t.name + ": " + name,
        t.city + ": " + city
      ];
      if (imgUrl) lines.push(t.imageLabel + ": " + imgUrl);
      return lines.join("\\n");
    }

    function buildWaLink(text) {
      return "https://api.whatsapp.com/send?phone=" + WA_NUMBER + "&text=" + encodeURIComponent(text);
    }

    function updateLink() {
      var name = (nameEl.value || "").trim();
      var city = (cityEl.value || "").trim();
      if (!name || !city) {
        waBtn.setAttribute("aria-disabled", "true");
        waBtn.href = "#";
        return;
      }
      var imgUrl = (imgEl && imgEl.src) ? absolutize(imgEl.src) : "";
      var text = buildMessage(name, city, imgUrl); // يضيف رابط الصورة كدليل
      waBtn.href = buildWaLink(text);
      waBtn.setAttribute("aria-disabled", "false");
    }

    nameEl.addEventListener("input", updateLink);
    cityEl.addEventListener("input", updateLink);
    updateLink();

    // منع النقر إذا كان معطّلاً
    waBtn.addEventListener("click", function(e){
      if (waBtn.getAttribute("aria-disabled")==="true") e.preventDefault();
    });
  })();
  </script>
</body>
</html>
"""

with open(os.path.join(project_dir, "index.html"), "w", encoding="utf-8") as f:
    f.write(index_html)

# 2) Create placeholder p.qpng (PNG image) 1200x1600 with simple text
w, h = 1200, 1600
img = Image.new("RGB", (w, h), (230, 230, 230))
draw = ImageDraw.Draw(img)

text = "p.qpng\nضع صورتك هنا"
# Try to load a default font
try:
    font = ImageFont.truetype("DejaVuSans.ttf", 64)
except:
    font = ImageFont.load_default()

# Wrap and center
lines = text.split("\n")
total_height = 0
line_sizes = []
for line in lines:
    size = draw.textbbox((0,0), line, font=font)
    line_w = size[2]-size[0]
    line_h = size[3]-size[1]
    line_sizes.append((line_w, line_h))
    total_height += line_h + 10
y = (h - total_height)//2
for i, line in enumerate(lines):
    line_w, line_h = line_sizes[i]
    x = (w - line_w)//2
    draw.text((x,y), line, fill=(80,80,80), font=font)
    y += line_h + 10

img_path = os.path.join(project_dir, "p.qpng")
img.save(img_path, format="PNG")

# 3) README.md
readme = """# WhatsApp Order Landing (Image + Name/City)

صفحة هبوط بسيطة لواتساب:
- صورة الحملة **p.qpng** في أعلى الصفحة
- حقلا **الاسم + المدينة**
- زر يفتح واتساب مع رسالة تأكيد + رابط الصورة كدليل الطلب

## الاستخدام
1. ضع هذه الملفات في مستودع GitHub (مثلاً `abomkdad/landing-pages` أو مستودع جديد).
2. **استبدل** الملف `p.qpng` بصورتك بنفس الاسم تمامًا (p.qpng).
3. افتح `index.html` في المتصفح (أو فعّل GitHub Pages) وجرب:
   - اكتب الاسم والمدينة → يصبح الزر فعّالًا وينتقل إلى واتساب.

## تغيير رقم الواتساب
افتح `index.html` وابحث عن `WA_NUMBER` واستبدل الرقم إذا لزم.

## ملاحظات
- الرسالة تتضمّن جملة التأكيد بالاعتماد على لغة جهاز العميل (عربي/عبري/إنجليزي) + رابط الصورة `p.qpng` كدليل.
- لا توجد نماذج أو نوافذ منبثقة — الزر رابط مباشر لـ api.whatsapp.com.
"""

with open(os.path.join(project_dir, "README.md"), "w", encoding="utf-8") as f:
    f.write(readme)

# 4) Zip the project
zip_path = "/mnt/data/whatsapp-order-landing-pqpng.zip"
with zipfile.ZipFile(zip_path, "w", zipfile.ZIP_DEFLATED) as z:
    for fname in ["index.html", "p.qpng", "README.md"]:
        z.write(os.path.join(project_dir, fname), arcname=fname)

zip_path
